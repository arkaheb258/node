/*! Data kompilacji: Tue Jul 28 2015 11:01:42 */
!function(a){var b="timeEntry";a.JQPlugin.createPlugin({name:b,defaultOptions:{appendText:"",showSeconds:!1,unlimitedHours:!1,timeSteps:[1,1,1],initialField:null,noSeparatorEntry:!1,tabToExit:!1,useMouseWheel:!0,defaultTime:null,minTime:null,maxTime:null,spinnerImage:"spinnerDefault.png",spinnerSize:[20,20,8],spinnerBigImage:"",spinnerBigSize:[40,40,16],spinnerIncDecOnly:!1,spinnerRepeat:[500,250],beforeShow:null,beforeSetTime:null},regionalOptions:{"":{show24Hours:!1,separator:":",ampmPrefix:"",ampmNames:["AM","PM"],spinnerTexts:["Now","Previous field","Next field","Increment","Decrement"]}},_getters:["getOffset","getTime","isDisabled"],_appendClass:b+"-append",_controlClass:b+"-control",_expandClass:b+"-expand",_disabledInputs:[],_instSettings:function(){return{_field:0,_selectedHour:0,_selectedMinute:0,_selectedSecond:0}},_postAttach:function(a,b){a.on("focus."+b.name,this._doFocus).on("blur."+b.name,this._doBlur).on("click."+b.name,this._doClick).on("keydown."+b.name,this._doKeyDown).on("keypress."+b.name,this._doKeyPress).on("paste."+b.name,function(){setTimeout(function(){c._parseTime(b)},1)})},_optionsChanged:function(b,c,d){var e=this._extractTime(c);a.extend(c.options,d),c.options.show24Hours=c.options.show24Hours||c.options.unlimitedHours,c._field=0,e&&this._setTime(c,new Date(0,0,0,e[0],e[1],e[2])),b.next("span."+this._appendClass).remove(),b.parent().find("span."+this._controlClass).remove(),a.fn.mousewheel&&b.unmousewheel();var f=c.options.spinnerImage?a('<span class="'+this._controlClass+'" style="display: inline-block; background: url(\''+c.options.spinnerImage+"') 0 0 no-repeat; width: "+c.options.spinnerSize[0]+"px; height: "+c.options.spinnerSize[1]+'px;"></span>'):null;b.after(c.options.appendText?'<span class="'+this._appendClass+'">'+c.options.appendText+"</span>":"").after(f||""),c.options.useMouseWheel&&a.fn.mousewheel&&b.mousewheel(this._doMouseWheel),f&&f.mousedown(this._handleSpinner).mouseup(this._endSpinner).mouseover(this._expandSpinner).mouseout(this._endSpinner).mousemove(this._describeSpinner)},enable:function(a){this._enableDisable(a,!1)},disable:function(a){this._enableDisable(a,!0)},_enableDisable:function(b,c){var d=this._getInst(b);d&&(b.disabled=c,b.nextSibling&&"span"===b.nextSibling.nodeName.toLowerCase()&&this._changeSpinner(d,b.nextSibling,c?5:-1),this._disabledInputs=a.map(this._disabledInputs,function(a){return a===b?null:a}),c&&this._disabledInputs.push(b))},isDisabled:function(b){return a.inArray(b,this._disabledInputs)>-1},_preDestroy:function(c){c=a(c).off("."+b),a.fn.mousewheel&&c.unmousewheel(),this._disabledInputs=a.map(this._disabledInputs,function(a){return a===c[0]?null:a}),c.siblings("."+this._appendClass+",."+this._controlClass).remove()},setTime:function(b,c){var d=this._getInst(b);d&&(null===c||""===c?a(b).val(""):this._setTime(d,c?a.isArray(c)?c:"object"==typeof c?new Date(c.getTime()):c:null))},getTime:function(a){var b=this._getInst(a),c=b?this._extractTime(b):null;return c?new Date(0,0,0,c[0],c[1],c[2]):null},getOffset:function(a){var b=this._getInst(a),c=b?this._extractTime(b):null;return c?1e3*(3600*c[0]+60*c[1]+c[2]):0},_doFocus:function(b){var d=b.nodeName&&"input"===b.nodeName.toLowerCase()?b:this;if(c._lastInput===d||c.isDisabled(d))return void(c._focussed=!1);var e=c._getInst(d);c._focussed=!0,c._lastInput=d,c._blurredInput=null,a.extend(e.options,a.isFunction(e.options.beforeShow)?e.options.beforeShow.apply(d,[d]):{}),c._parseTime(e,b.nodeName?null:b),setTimeout(function(){c._showField(e)},10)},_doBlur:function(){c._blurredInput=c._lastInput,c._lastInput=null},_doClick:function(a){var b=a.target,d=c._getInst(b),e=d._field;c._focussed||(d._field=c._getSelection(d,b,a)),e!==d._field&&(d._lastChr=""),c._showField(d),c._focussed=!1},_getSelection:function(b,c,d){var e=0,f=[b.elem.val().split(b.options.separator)[0].length,2,2];if(null!==c.selectionStart)for(var g=0,h=0;h<=Math.max(1,b._secondField,b._ampmField)&&(g+=h!==b._ampmField?f[h]+b.options.separator.length:b.options.ampmPrefix.length+b.options.ampmNames[0].length,e=h,!(c.selectionStart<g));h++);else if(c.createTextRange&&null!=d)for(var i=a(d.srcElement),j=c.createTextRange(),k=function(a){return{thin:2,medium:4,thick:6}[a]||a},l=d.clientX+document.documentElement.scrollLeft-(i.offset().left+parseInt(k(i.css("border-left-width")),10))-j.offsetLeft,h=0;h<=Math.max(1,b._secondField,b._ampmField);h++){var g=h!==b._ampmField?h*fieldSize+2:b._ampmField*fieldSize+b.options.ampmPrefix.length+b.options.ampmNames[0].length;if(j.collapse(),j.moveEnd("character",g),e=h,l<j.boundingWidth)break}return e},_doKeyDown:function(a){if(a.keyCode>=48)return!0;var b=c._getInst(a.target);switch(a.keyCode){case 9:return b.options.tabToExit?!0:a.shiftKey?c._changeField(b,-1,!0):c._changeField(b,1,!0);case 35:a.ctrlKey?c._setValue(b,""):(b._field=Math.max(1,b._secondField,b._ampmField),c._adjustField(b,0));break;case 36:a.ctrlKey?c._setTime(b):(b._field=0,c._adjustField(b,0));break;case 37:c._changeField(b,-1,!1);break;case 38:c._adjustField(b,1);break;case 39:c._changeField(b,1,!1);break;case 40:c._adjustField(b,-1);break;case 46:c._setValue(b,"");break;case 8:b._lastChr="";default:return!0}return!1},_doKeyPress:function(a){var b=String.fromCharCode(void 0===a.charCode?a.keyCode:a.charCode);if(" ">b)return!0;var d=c._getInst(a.target);return c._handleKeyPress(d,b),!1},_handleKeyPress:function(a,b){if(b===a.options.separator)this._changeField(a,1,!1);else if(b>="0"&&"9">=b){var c=parseInt(b,10),d=parseInt(a._lastChr+b,10),e=0!==a._field?a._selectedHour:a.options.unlimitedHours?d:a.options.show24Hours?24>d?d:c:(d>=1&&12>=d?d:c>0?c:a._selectedHour)%12+(a._selectedHour>=12?12:0),f=1!==a._field?a._selectedMinute:60>d?d:c,g=a._field!==a._secondField?a._selectedSecond:60>d?d:c,h=this._constrainTime(a,[e,f,g]);this._setTime(a,a.options.unlimitedHours?h:new Date(0,0,0,h[0],h[1],h[2])),a.options.noSeparatorEntry&&a._lastChr?this._changeField(a,1,!1):a._lastChr=a.options.unlimitedHours&&0===a._field?a._lastChr+b:b}else if(!a.options.show24Hours&&(b=b.toLowerCase(),b===a.options.ampmNames[0].substring(0,1).toLowerCase()&&a._selectedHour>=12||b===a.options.ampmNames[1].substring(0,1).toLowerCase()&&a._selectedHour<12)){var i=a._field;a._field=a._ampmField,this._adjustField(a,1),a._field=i,this._showField(a)}},_doMouseWheel:function(a,b){if(!c.isDisabled(a.target)){var d=c._getInst(a.target);d.elem.focus(),d.elem.val()||c._parseTime(d),c._adjustField(d,b),a.preventDefault()}},_expandSpinner:function(b){var d=c._getSpinnerTarget(b),e=c._getInst(c._getInput(d));if(!c.isDisabled(e.elem[0])&&e.options.spinnerBigImage){e._expanded=!0;var f=a(d).offset(),g=null;a(d).parents().each(function(){var b=a(this);return("relative"===b.css("position")||"absolute"===b.css("position"))&&(g=b.offset()),!g}),a('<div class="'+c._expandClass+'" style="position: absolute; left: '+(f.left-(e.options.spinnerBigSize[0]-e.options.spinnerSize[0])/2-(g?g.left:0))+"px; top: "+(f.top-(e.options.spinnerBigSize[1]-e.options.spinnerSize[1])/2-(g?g.top:0))+"px; width: "+e.options.spinnerBigSize[0]+"px; height: "+e.options.spinnerBigSize[1]+"px; background: transparent url("+e.options.spinnerBigImage+') no-repeat 0px 0px; z-index: 10;"></div>').mousedown(c._handleSpinner).mouseup(c._endSpinner).mouseout(c._endExpand).mousemove(c._describeSpinner).insertAfter(d)}},_getInput:function(b){return a(b).siblings("."+this._getMarker())[0]},_describeSpinner:function(a){var b=c._getSpinnerTarget(a),d=c._getInst(c._getInput(b));b.title=d.options.spinnerTexts[c._getSpinnerRegion(d,a)]},_handleSpinner:function(b){var d=c._getSpinnerTarget(b),e=c._getInput(d);if(!c.isDisabled(e)){e===c._blurredInput&&(c._lastInput=e,c._blurredInput=null);var f=c._getInst(e);c._doFocus(e);var g=c._getSpinnerRegion(f,b);c._changeSpinner(f,d,g),c._actionSpinner(f,g),c._timer=null,c._handlingSpinner=!0,g>=3&&f.options.spinnerRepeat[0]&&(c._timer=setTimeout(function(){c._repeatSpinner(f,g)},f.options.spinnerRepeat[0]),a(d).one("mouseout",c._releaseSpinner).one("mouseup",c._releaseSpinner))}},_actionSpinner:function(a,b){switch(a.elem.val()||c._parseTime(a),b){case 0:this._setTime(a);break;case 1:this._changeField(a,-1,!1);break;case 2:this._changeField(a,1,!1);break;case 3:this._adjustField(a,1);break;case 4:this._adjustField(a,-1)}},_repeatSpinner:function(a,b){c._timer&&(c._lastInput=c._blurredInput,this._actionSpinner(a,b),this._timer=setTimeout(function(){c._repeatSpinner(a,b)},a.options.spinnerRepeat[1]))},_releaseSpinner:function(){clearTimeout(c._timer),c._timer=null},_endExpand:function(b){c._timer=null;var d=c._getSpinnerTarget(b),e=c._getInput(d),f=c._getInst(e);a(d).remove(),f._expanded=!1},_endSpinner:function(a){c._timer=null;var b=c._getSpinnerTarget(a),d=c._getInput(b),e=c._getInst(d);c.isDisabled(d)||c._changeSpinner(e,b,-1),c._handlingSpinner&&(c._lastInput=c._blurredInput),c._lastInput&&c._handlingSpinner&&c._showField(e),c._handlingSpinner=!1},_getSpinnerTarget:function(a){return a.target||a.srcElement},_getSpinnerRegion:function(b,c){var d=this._getSpinnerTarget(c),e=a(d).offset(),f=[document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop],g=b.options.spinnerIncDecOnly?99:c.clientX+f[0]-e.left,h=c.clientY+f[1]-e.top,i=b.options[b._expanded?"spinnerBigSize":"spinnerSize"],j=b.options.spinnerIncDecOnly?99:i[0]-1-g,k=i[1]-1-h;if(i[2]>0&&Math.abs(g-j)<=i[2]&&Math.abs(h-k)<=i[2])return 0;var l=Math.min(g,h,j,k);return l===g?1:l===j?2:l===h?3:4},_changeSpinner:function(b,c,d){a(c).css("background-position","-"+(d+1)*b.options[b._expanded?"spinnerBigSize":"spinnerSize"][0]+"px 0px")},_parseTime:function(a,b){var d=this._extractTime(a);if(d)a._selectedHour=d[0],a._selectedMinute=d[1],a._selectedSecond=d[2];else{var e=this._constrainTime(a);a._selectedHour=e[0],a._selectedMinute=e[1],a._selectedSecond=a.options.showSeconds?e[2]:0}a._secondField=a.options.showSeconds?2:-1,a._ampmField=a.options.show24Hours?-1:a.options.showSeconds?3:2,a._lastChr="";var f=function(){""!==a.elem.val()&&c._showTime(a)};"number"==typeof a.options.initialField?(a._field=Math.max(0,Math.min(Math.max(1,a._secondField,a._ampmField),a.options.initialField)),f()):setTimeout(function(){a._field=c._getSelection(a,a.elem[0],b),f()},0)},_extractTime:function(a,b){b=b||a.elem.val();var c=b.split(a.options.separator);if(""===a.options.separator&&""!==b&&(c[0]=b.substring(0,2),c[1]=b.substring(2,4),c[2]=b.substring(4,6)),c.length>=2){var d=!a.options.show24Hours&&b.indexOf(a.options.ampmNames[0])>-1,e=!a.options.show24Hours&&b.indexOf(a.options.ampmNames[1])>-1,f=parseInt(c[0],10);f=isNaN(f)?0:f,f=((d||e)&&12===f?0:f)+(e?12:0);var g=parseInt(c[1],10);g=isNaN(g)?0:g;var h=c.length>=3?parseInt(c[2],10):0;return h=isNaN(h)||!a.options.showSeconds?0:h,this._constrainTime(a,[f,g,h])}return null},_constrainTime:function(a,b){var c=null!==b&&void 0!==b;if(!c){var d=this._determineTime(a.options.defaultTime,a)||new Date;b=[d.getHours(),d.getMinutes(),d.getSeconds()]}for(var e=!1,f=0;f<a.options.timeSteps.length;f++)e?b[f]=0:a.options.timeSteps[f]>1&&(b[f]=Math.round(b[f]/a.options.timeSteps[f])*a.options.timeSteps[f],e=!0);return b},_showTime:function(a){var b=(a.options.unlimitedHours?a._selectedHour:this._formatNumber(a.options.show24Hours?a._selectedHour:(a._selectedHour+11)%12+1))+a.options.separator+this._formatNumber(a._selectedMinute)+(a.options.showSeconds?a.options.separator+this._formatNumber(a._selectedSecond):"")+(a.options.show24Hours?"":a.options.ampmPrefix+a.options.ampmNames[a._selectedHour<12?0:1]);this._setValue(a,b),this._showField(a)},_showField:function(a){var b=a.elem[0];if(!a.elem.is(":hidden")&&c._lastInput===b){for(var d=[a.elem.val().split(a.options.separator)[0].length,2,2],e=0,f=0;f<a._field;)e+=d[f]+(f===Math.max(1,a._secondField)?0:a.options.separator.length),f++;var g=e+(a._field!==a._ampmField?d[f]:a.options.ampmPrefix.length+a.options.ampmNames[0].length);if(b.setSelectionRange)b.setSelectionRange(e,g);else if(b.createTextRange){var h=b.createTextRange();h.moveStart("character",e),h.moveEnd("character",g-a.elem.val().length),h.select()}b.disabled||b.focus()}},_formatNumber:function(a){return(10>a?"0":"")+a},_setValue:function(a,b){b!==a.elem.val()&&a.elem.val(b).trigger("change")},_changeField:function(a,b,c){var d=""===a.elem.val()||a._field===(-1===b?0:Math.max(1,a._secondField,a._ampmField));return d||(a._field+=b),this._showField(a),a._lastChr="",d&&c},_adjustField:function(a,b){""===a.elem.val()&&(b=0),a.options.unlimitedHours?this._setTime(a,[a._selectedHour+(0===a._field?b*a.options.timeSteps[0]:0),a._selectedMinute+(1===a._field?b*a.options.timeSteps[1]:0),a._selectedSecond+(a._field===a._secondField?b*a.options.timeSteps[2]:0)]):this._setTime(a,new Date(0,0,0,a._selectedHour+(0===a._field?b*a.options.timeSteps[0]:0)+(a._field===a._ampmField?12*b:0),a._selectedMinute+(1===a._field?b*a.options.timeSteps[1]:0),a._selectedSecond+(a._field===a._secondField?b*a.options.timeSteps[2]:0)))},_setTime:function(b,c){if(b.options.unlimitedHours&&a.isArray(c))var d=c;else{c=this._determineTime(c,b);var d=c?[c.getHours(),c.getMinutes(),c.getSeconds()]:null}d=this._constrainTime(b,d),c=new Date(0,0,0,d[0],d[1],d[2]);var c=this._normaliseTime(c),e=this._normaliseTime(this._determineTime(b.options.minTime,b)),f=this._normaliseTime(this._determineTime(b.options.maxTime,b));if(b.options.unlimitedHours){for(;d[2]<0;)d[2]+=60,d[1]--;for(;d[2]>59;)d[2]-=60,d[1]++;for(;d[1]<0;)d[1]+=60,d[0]--;for(;d[1]>59;)d[1]-=60,d[0]++;e=null!=b.options.minTime&&a.isArray(b.options.minTime)?b.options.minTime:[0,0,0],d[0]<e[0]?d=e.slice(0,3):d[0]===e[0]&&(d[1]<e[1]?(d[1]=e[1],d[2]=e[2]):d[1]===e[1]&&d[2]<e[2]&&(d[2]=e[2])),null!=b.options.maxTime&&a.isArray(b.options.maxTime)&&(d[0]>b.options.maxTime[0]?d=b.options.maxTime.slice(0,3):d[0]===b.options.maxTime[0]&&(d[1]>b.options.maxTime[1]?(d[1]=b.options.maxTime[1],d[2]=b.options.maxTime[2]):d[1]===b.options.maxTime[1]&&d[2]>b.options.maxTime[2]&&(d[2]=b.options.maxTime[2])))}else e&&f&&e>f?e>c&&c>f&&(c=Math.abs(c-e)<Math.abs(c-f)?e:f):c=e&&e>c?e:f&&c>f?f:c,d[0]=c.getHours(),d[1]=c.getMinutes(),d[2]=c.getSeconds();a.isFunction(b.options.beforeSetTime)&&(c=b.options.beforeSetTime.apply(b.elem[0],[this.getTime(b.elem[0]),c,e,f]),d[0]=c.getHours(),d[1]=c.getMinutes(),d[2]=c.getSeconds()),b._selectedHour=d[0],b._selectedMinute=d[1],b._selectedSecond=d[2],this._showTime(b)},_determineTime:function(b,d){var e=function(a){var b=new Date;return b.setTime(b.getTime()+1e3*a),b},f=function(a){var b=c._extractTime(d,a),e=new Date,f=b?b[0]:e.getHours(),g=b?b[1]:e.getMinutes(),h=b?b[2]:e.getSeconds();if(!b)for(var i=/([+-]?[0-9]+)\s*(s|S|m|M|h|H)?/g,j=i.exec(a);j;){switch(j[2]||"s"){case"s":case"S":h+=parseInt(j[1],10);break;case"m":case"M":g+=parseInt(j[1],10);break;case"h":case"H":f+=parseInt(j[1],10)}j=i.exec(a)}return e=new Date(0,0,10,f,g,h,0),/^!/.test(a)&&(e.getDate()>10?e=new Date(0,0,10,23,59,59):e.getDate()<10&&(e=new Date(0,0,10,0,0,0))),e},g=function(a){return new Date(0,0,0,a[0],a[1]||0,a[2]||0,0)};return b?"string"==typeof b?f(b):"number"==typeof b?e(b):a.isArray(b)?g(b):b:null},_normaliseTime:function(a){return a?(a.setFullYear(1900),a.setMonth(0),a.setDate(0),a):null}});var c=a.timeEntry}(jQuery);